<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Product Details</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css"/>
  <link rel="icon" href="/images/assets/iconAmazon.jpeg" type="image/icon type">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/product.css">

  
</head>
<body>
  <nav class="nav">
    <div class="amazonLogo">
        <a href="/html/main.html">
            <img src="/images/amazon_logo.png"  width="130px" alt="">
        </a>
    </div>      
    <div class="nav-country">
    
        <img src="/images/location_icon.png" height="20" alt="">
       
        <div class="area">
            <p  class="p1">Deliver to</p>
            <p class="p2">Egypt</p>
        </div>
    </div>

    <div class=" nav-search">
      <div class="all-search">
        <p >All</p>
        <img src="/images/dropdown_icon.png" height="7" alt="">
      </div>
        <input class="search-bar-input" type="search" placeholder="search Amazon" >
        
        <img  class="search-bar-img" src="/images/search_icon.png"  alt="">
   
    </div>
    <div class="country-flag">
        <img src="/images/assets/phalitain.png" height="13 " alt="">
        <p>PS</p>
        <img src="/images/dropdown_icon.png" height="8" alt="">
    </div>
    <div  class="nav-text" >
        <a href="signUp.html">
            <p>Hello, sign in</p> 
        <h4>Account & Lists <img src="/images/dropdown_icon.png" height="7" alt=""></h4> 

        </a>
    </div>
    <div class="orers">
        <a href="">
            <p>
                Return
            </p> 
            <h4>& Orders</h4>
        </a>
      
    </div>
    <a href="cart.html">
        <div class="cart">
          <i class="fa-solid fa-cart-shopping icon-1 "></i>

          <div id="cartAmount" class="cartAmount">0</div>
        </div>
      </a>

</nav>

  <div class="product-details" id="productDetails">
    <!-- Product details will be injected here -->
  </div>

  <footer>
    <div class="back-to-top">
        <a href="#">Back to top</a>
    </div>
    <div class="footer-container">
        
        <div class="footer-column">
            <h3>Get to know us</h3>
            <ul>
                <li>Careers</li>
                <li>Blog</li>
                <li>About Amazon</li>
                <li>Investor Relations</li>
                <li>Amazon Devices</li>
                <li>Amazon Science</li>
            </ul>
        </div>
        <div class="footer-column">
            <h3>Make Money with Us</h3>
            <ul>
                <li>Sell Products on Amazon</li>
                <li>Sell on Amazon Business</li>
                <li>Sell apps on Amazon</li>
                <li>Become an Affiliate</li>
                <li>Advertise your Products</li>
                <li>Self-publish with Us</li>
                <li>Host an Amazon Hub</li>
                <li>See More Make Money With Us</li>
            </ul>
        </div>
        <div class="footer-column">
            <h3>Amazon Payment Products</h3>
            <ul>
                <li>Amazon Business Card</li>
                <li>Shop with Points</li>
                <li>Reload Your Balance</li>
                <li>Amazon Currency Converter</li>
            </ul>
        </div>
        <div class="footer-column">
            <h3>Let Us Help You</h3>
            <ul>
                <li>Amazon and COVID-19</li>
                <li>Your Account</li>
                <li>Your Orders</li>
                <li>Shipping Rates & Policies</li>
                <li>Returns & Replacements</li>
                <li>Manage Your Content and Devices</li>
                <li>Help</li>
            </ul>
        </div>
       
        
    </div>
    <hr class="hr"> 
    <div class="divbtn">
        <div >
            <img src="/images/amazon_logo.png" alt="" id="icon">
            </div>
            <div >
                <button class="btn1">
                    <div>
                        <i class="fa-solid fa-earth-americas"></i>

                    </div>
                    <div>
                        English

                    </div>
                </button>
            </div>
            <div>
                <button class="btn2">
                    $ USD - U.S. Dollar
                </button>
            </div> <div>
                <button class="btn1">
                    <h2>
                        <img src="/images/assets/phalitain.png" height="13" alt="">
                    </h2>
                    Palestine
                </button>
            </div>
    </div>
        
</footer>
  <!-- Include the data file here -->
  <script src="/js/data.js"></script>

  <!-- Main script -->
  <script>
    let urlParams = new URLSearchParams(window.location.search);
    let productId = urlParams.get('id');

    let cart = JSON.parse(localStorage.getItem("data")) || [];

    let getProductDetails = (id) => {
      return shopItemsData.find((item) => item.id === id);
    };

    let productDetails = getProductDetails(productId);

    if (productDetails) {
      let search = cart.find((x) => x.id === productId) || {};
      document.getElementById('productDetails').innerHTML = `
        <div class="item-details">
          <img src="${productDetails.img}" alt="${productDetails.name}">
          <h2>${productDetails.name}</h2>
          <p>${productDetails.desc}</p>
          <h3>$${productDetails.price}</h3>
          <div class="price-quantity">
            <div class="buttons">
              <i onclick="decrement('${productDetails.id}')" class="bi bi-dash-lg "></i>
              <div id="${productDetails.id}" class="quantity">
                ${search.item === undefined ? 0 : search.item}
              </div>
              <i onclick="increment('${productDetails.id}')" class="bi bi-plus-lg "></i>
            </div>
          </div>
        </div>
      `;
    } else {
      document.getElementById('productDetails').innerHTML = `
        <p>Product not found.</p>
      `;
    }

    let increment = (id) => {
      let search = cart.find((x) => x.id === id);

      if (search === undefined) {
        cart.push({
          id: id,
          item: 1,
        });
      } else {
        search.item += 1;
      }

      update(id);
      localStorage.setItem("data", JSON.stringify(cart));
    };

    let decrement = (id) => {
      let search = cart.find((x) => x.id === id);

      if (search === undefined) return;
      else if (search.item === 0) return;
      else {
        search.item -= 1;
      }

      update(id);
      cart = cart.filter((x) => x.item !== 0);
      localStorage.setItem("data", JSON.stringify(cart));
    };

    let update = (id) => {
      let search = cart.find((x) => x.id === id);
      document.getElementById(id).innerHTML = search ? search.item : 0;
      calculation();
    };

    let calculation = () => {
      let cartIcon = document.getElementById("cartAmount");
      cartIcon.innerHTML = cart.map((x) => x.item).reduce((x, y) => x + y, 0);
    };

    calculation();
  </script>
</body>
</html>